import{k as f,N as d,r as h,I as g,h as y,c as l,a as v,F as k,f as w,o,M as N,n as S,j as s,t as A}from"#entry";import{_ as B}from"./DlAUqK2U.js";const F={class:"viewer-container w-full h-screen relative bg-gray-100 overflow-hidden"},j={class:"canvas relative w-full h-full"},C={key:0,class:"cms-text w-full h-full whitespace-pre-wrap"},I=["src"],M=["src"],z=["src"],D={__name:"[id]",setup(L){const a=d(),_=f(),i=a.params.id,u=_.mainDevServer,r=h([]),p=g(()=>r.value.filter(t=>t.page_route_link_belong===i));function m(t){return t?Array.isArray(t)?t:typeof t=="string"?[{url:t,name:"file"}]:t.url?[t]:[]:[]}return y(async()=>{try{const t=await fetch(`${u}/api/cms/boxes/?page=${i}`);if(!t.ok){r.value=[];return}const c=await t.json(),e=Array.isArray(c?.boxes)?c.boxes:[];r.value=e.map(n=>({cms_id:n.cms_id||"",component_width:Number(n.component_width)||240,component_height:Number(n.component_height)||180,component_top:Number(n.component_top)||0,component_left:Number(n.component_left)||0,component_type:n.component_type||"text",component_content:n.component_content||"",file_url:m(n.file_url),page_route_link_belong:n.page_route_link_belong||"",component_design_styles:n.component_design_styles||""}))}catch(t){console.error("Failed loading CMS:",t),r.value=[]}}),(t,c)=>(o(),l("div",F,[v("div",j,[(o(!0),l(k,null,w(p.value,e=>(o(),l("div",{key:e.cms_id,class:S(["cms-box absolute",e.component_design_styles]),style:N({width:(e.component_width||240)+"px",height:(e.component_height||180)+"px",top:(e.component_top||0)+"px",left:(e.component_left||0)+"px"})},[e.component_type==="text"?(o(),l("div",C,A(e.component_content),1)):s("",!0),["image","image_link"].includes(e.component_type)&&e.file_url.length&&e.file_url[0].url?(o(),l("img",{key:1,src:e.file_url[0].url,class:"cms-image w-full h-full object-cover"},null,8,I)):s("",!0),e.component_type==="video"&&e.file_url.length&&e.file_url[0].url?(o(),l("iframe",{key:2,src:e.file_url[0].url,class:"w-full h-full",frameborder:"0",allowfullscreen:""},null,8,M)):s("",!0),e.component_type==="file"&&e.file_url.length&&e.file_url[0].url?(o(),l("iframe",{key:3,src:e.file_url[0].url,class:"w-full h-full"},null,8,z)):s("",!0)],6))),128))])]))}},V=B(D,[["__scopeId","data-v-e4f96f9a"]]);export{V as default};
