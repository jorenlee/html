import{r as h,e as N,I as S,c as a,a as u,t as L,d as C,m as v,z as w,F as X,g as B,al as P,o as s,M as j,i as d,p as g,A as F,f as O,n as $}from"#entry";const A={class:"relative w-full h-screen bg-gray-100 p-4 select-none overflow-x-hidden"},H={class:"flex gap-2 mb-4"},W=["onClick"],J=["onMousedown"],q=["onUpdate:modelValue"],G=["onUpdate:modelValue"],K=["onChange"],Q=["onUpdate:modelValue"],Z=["onInput"],ee={class:"w-full h-full"},te=["contenteditable","onInput"],oe=["src","onMousedown"],le=["src"],ne={key:3,class:"w-full h-full p-2 overflow-auto border rounded bg-gray-50"},ae=["src"],se=["src"],re=["href"],ue=["onMousedown"],pe={__name:"index",setup(ie){const i=h(!1),m=h("page1"),f=h([]);let y=1;const E=P();N(async()=>{const t=await(await fetch("/data.json")).json();f.value=t,t.length&&(y=Math.max(...t.map(e=>e.id))+1)});function M(){f.value.push({id:y++,width:240,height:180,top:100,left:100,type:"text",content:"Sample Text",textColor:"text-black",bgColor:"bg-white",fileData:null,fileName:"",fileType:"",videoEmbed:null,page_route_link_belong:m.value})}const r=S(()=>f.value.filter(o=>o.page_route_link_belong===m.value));let p=null;function _(o,t){i.value&&(p={index:t,startX:o.clientX,startY:o.clientY,startTop:r.value[t].top,startLeft:r.value[t].left},document.addEventListener("mousemove",x),document.addEventListener("mouseup",b))}function x(o){if(!p)return;const t=r.value[p.index];t.top=p.startTop+(o.clientY-p.startY),t.left=p.startLeft+(o.clientX-p.startX)}function b(){p=null,document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b)}let c=null;function T(o,t){c={index:t,startX:o.clientX,startY:o.clientY,startW:r.value[t].width,startH:r.value[t].height},document.addEventListener("mousemove",k),document.addEventListener("mouseup",D)}function k(o){if(!c)return;const t=r.value[c.index];t.width=c.startW+(o.clientX-c.startX),t.height=c.startH+(o.clientY-c.startY)}function D(){c=null,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",D)}function U(o,t){r.value[t].content=o.target.innerText}function I(o,t){const e=o.target.files[0];if(!e)return;const n=new FileReader;n.onload=()=>{r.value[t].fileData=n.result,r.value[t].fileName=e.name,r.value[t].fileType=e.name.split(".").pop().toLowerCase()},n.readAsDataURL(e)}function V(o,t){const e=o.target.value;if(!e)return;let n="";try{const l=new URL(e);l.hostname.includes("youtube.com")?n=l.searchParams.get("v"):l.hostname.includes("youtu.be")&&(n=l.pathname.slice(1)),n&&(r.value[t].videoEmbed="https://www.youtube.com/embed/"+n)}catch{console.error("Invalid YouTube URL")}}function R(o){return`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(o)}`}async function Y(){const t=await(await fetch("/api/boxes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f.value)})).json();alert(t.message),console.log(f.value)}function z(o){E.push(`/control-box/${o}`)}return(o,t)=>(s(),a("div",A,[u("div",H,[u("button",{class:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",onClick:M}," Add Box "),u("button",{class:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",onClick:t[0]||(t[0]=e=>i.value=!i.value)},L(i.value?"Disable Edit Mode":"Enable Edit Mode"),1),u("button",{class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:Y}," Save Boxes "),u("div",null,[t[3]||(t[3]=C(" Current Page: ",-1)),v(u("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>m.value=e),class:"border rounded px-1 w-32"},null,512),[[w,m.value]])])]),(s(!0),a(X,null,B(r.value,(e,n)=>(s(),a("div",{key:e.id,class:"absolute border border-purple-600 rounded-md shadow-md cursor-pointer",style:j({width:e.width+"px",height:e.height+"px",top:e.top+"px",left:e.left+"px"}),onClick:l=>!i.value&&z(e.page_route_link_belong)},[i.value?(s(),a("div",{key:0,class:"absolute -top-14 left-0 w-full bg-white shadow-md rounded p-2 flex gap-2 items-center z-50",onMousedown:t[2]||(t[2]=g(()=>{},["stop"]))},[u("div",{class:"w-full p-1 bg-purple-600 text-white text-xs cursor-move flex items-center gap-1 rounded-t-md",onMousedown:g(l=>_(l,n),["stop"])},[...t[4]||(t[4]=[u("i",{class:"fa-solid fa-arrows-up-down-left-right"},null,-1),C(" Drag ",-1)])],40,J),v(u("select",{"onUpdate:modelValue":l=>e.type=l,class:"border rounded px-1 text-sm"},[...t[5]||(t[5]=[O('<option value="text">Text</option><option value="image">Image</option><option value="image_link">Image Link</option><option value="video">Video</option><option value="file">File</option>',5)])],8,q),[[F,e.type]]),v(u("input",{type:"text","onUpdate:modelValue":l=>e.page_route_link_belong=l,placeholder:"Page ID",class:"border rounded px-1 text-sm w-32"},null,8,G),[[w,e.page_route_link_belong]]),e.type==="image"||e.type==="file"?(s(),a("input",{key:0,type:"file",onChange:l=>I(l,n)},null,40,K)):d("",!0),e.type==="image_link"?v((s(),a("input",{key:1,type:"url",placeholder:"Image URL","onUpdate:modelValue":l=>e.fileData=l,class:"border rounded px-1 w-40"},null,8,Q)),[[w,e.fileData]]):d("",!0),e.type==="video"?(s(),a("input",{key:2,type:"url",placeholder:"YouTube URL",onInput:l=>V(l,n),class:"border rounded px-1 w-40"},null,40,Z)):d("",!0)],32)):d("",!0),u("div",ee,[e.type==="text"?(s(),a("div",{key:0,class:$(["w-full h-full p-2 whitespace-pre-wrap break-words",[e.textColor,e.bgColor,i.value?"border rounded":""]]),contenteditable:i.value,onInput:l=>U(l,n)},null,42,te)):d("",!0),["image","image_link"].includes(e.type)&&e.fileData?(s(),a("img",{key:1,src:e.fileData,class:"w-full h-full object-contain",onMousedown:g(l=>_(l,n),["stop"])},null,40,oe)):d("",!0),e.type==="video"&&e.videoEmbed?(s(),a("iframe",{key:2,src:e.videoEmbed,class:"w-full h-64",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,8,le)):d("",!0),e.type==="file"&&e.fileData?(s(),a("div",ne,[e.fileType==="pdf"?(s(),a("iframe",{key:0,src:e.fileData,class:"w-full h-full"},null,8,ae)):["doc","docx","xls","xlsx"].includes(e.fileType)?(s(),a("iframe",{key:1,src:R(e.fileData),class:"w-full h-full"},null,8,se)):(s(),a("a",{key:2,href:e.fileData,target:"_blank",class:"text-blue-600 underline"},L(e.fileName),9,re))])):d("",!0)]),i.value?(s(),a("div",{key:1,class:"absolute bottom-0 right-0 w-4 h-4 bg-purple-600 cursor-se-resize rounded-br",onMousedown:g(l=>T(l,n),["stop"])},null,40,ue)):d("",!0)],12,W))),128))]))}};export{pe as default};
